%!TEX root = ../thesis.tex
\input{noise.tex}

\externaldocument[A-]{Chapters/DRIE.tex}
\externaldocument[A-]{Chapters/Muxmon.tex}

\chapter{Photon number calculation}
  \label{ch:photon number calculation}

  In cQED resonators usually operate in the single-photon regime. It is therefore important to know what power is required to reach this regime. In the equilibrium state of the resonator the power absorbed $P_\text{abs}$ by the resonator is equal to the power leaking out of the resonator, and so the absorbed power $P_\text{abs}$ can be expressed as

  \begin{equation}
    P_\text{abs} = \left<n_\text{ph}\right>\hbar\omega_r \kappa,
    \label{eq:Pabs-nph}
  \end{equation}
  where $\kappa=\omega_r/Q_i$ is the cavity decay rate.

  The absorbed power $P_\text{abs}$ can also be expressed in terms of the input power $P_\text{in}$ entering the feedline. We note that the absorbed power $P_\text{abs}$ is equal to the input power $P_\text{in}$ entering the feedline minus the reflected power $P_\text{refl}$ and the transmitted power $P_\text{trans}$. These are given by

  \begin{align}
    P_\text{refl} = P_\text{in}\left|S_{11}\right|^2;\\
    P_\text{trans} = P_\text{in}\left|S_{21}\right|^2,
  \end{align}
  where $S_{11}$ and $S_{21}$ are the scattering parameters. At the resonance frequency $S_{21}=\frac{Q_c}{Q_i+Q_c}$ (see Eq.~\ref{eq:S21min}), and $S_{11}=S_{21}-1$. Therefore the absorbed power is equal to

  \begin{equation}
    P_\text{abs}=1-P_\text{refl}-P_\text{trans}=\frac{2Q_l^2}{Q_c Q_i}P_\text{in}.
    \label{Pabs-Pin}
  \end{equation}
  Combining Eqs.~\ref{eq:Pabs-nph} and~\ref{Pabs-Pin}, we arrive at a formula for the mean photon number $\left<n_\text{ph}\right>$:

  \begin{equation}
    \left<n_\text{ph}\right> = \frac{2}{\hbar \omega_r}\frac{Q_l^2}{Q_c}P_\text{in}.
  \end{equation}
  The input power $P_\text{in}$ can be found by measuring the transmission of the components between the generator and feedline.



\chapter{Duplexer isolation}
  \label{ch:Duplexer isolation}

  \begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{Figures/Appendix/Duplexer isolation.png}
    \caption{Isolation of the Duplexer. Legend indices correspond to switch state ($1$ means open, $0$ means closed, lsb corresponds to bottom drive line, msb to top drive line). Transmission is measured relative to the transmission when all channels are open (11). The black line corresponds to the measured noise floor. The red-dashed line indicates the frequency of the top and bottom qubit, and the blue-dashed line to the ancilla qubit, during the Muxmon experiment.}
    \label{fig:Duplexer isolation}
  \end{figure}

  The isolation of the Duplexer switches has been measured. During the measurements a signal was sent through input channel $1$ and $2$, corresponding to the signal of the main Gaussian pulse, and derivative pulse, respectively. For each input channel the transmission to each of the two output channels has been measured. These output channels are connected to the drive lines of the top and bottom qubit during the Muxmon experiment. For each input-output-port combination the transmission has been measured for different switch configurations, which were controlled using the nanosecond switches. Four different switch combinations were used, corresponding the the four distinct possibilities of the signal being directed to each of the two output channels.

  The results of the isolation measurements are shown in Fig.~\ref{fig:Duplexer isolation}. As can be seen in all four input-output combinations the isolation is around \SI{50}{\dBm} at the frequency of top and bottom qubit. Furthermore, the isolation does not seem to depend strongly on whether the switch to the other output port is open or closed.

\chapter{Chip characterization}

  \section{Muxmon1 cross-driving}
    \label{sec:Muxmon1 cross-driving}
      \begin{table}[h]
        \begin{tabular}{l c c}
          \toprule
          qubit & \multicolumn{2}{c}{cross-driving (\%)} \\
          \cmidrule(lr){2-3}
               & top-ancilla drive line & bottom-ancilla drive line \\
          \midrule
          Top     & $100$    & $5.22$ \\
          Ancilla & $75$ & $62.5$ \\
          Bottom  & $1.05$ & $100$    \\
          \bottomrule
        \end{tabular}
        \label{tab:Muxmon1 cross-driving}
      \end{table}

  \section{Muxmon0 resonator buses}
    \label{sec:Resonator buses}

    \begin{figure}[h]
      \centering
      \includegraphics[width=\textwidth]{Figures/Appendix/resonator buses.png}
      \caption{Normalized transmission showing the resonator buses of the top and bottom qubit, at frequencies \SI{4.88}{\giga \hertz} and \SI{4.97}{\giga \hertz}, respectively.}
      \label{fig:resonator buses}
    \end{figure}

    The top and bottom qubit are each coupled to a resonator bus. When the frequency of a qubit approaches that of the bus, they experience an avoided crossing. In Fig.~\ref{fig:resonator buses} these avoided crossing are shown for the top and bottom qubit. For the top qubit the frequency of the resonator bus is found to be \SI{4.88}{\giga \hertz}. For the bottom qubit the signal was considerably worse, but the frequency of the resonator bus is found to be roughly \SI{4.97}{\giga \hertz}. For the top qubit the coupling strength $g$ between the qubit and the bus can be extracted. It is equal to half the minimum distance, and approximately equal to \SI{27}{\mega \hertz}.

\chapter{Additional notes}
  \section{Qubit characterization}
      \subsection{Finding the qubit sweet spot using a one-dimensional scan}
        \label{Finding the qubit sweet spot using a one-dimensional scan}
        \begin{figure}[tb]
          \centering
          \includegraphics[width=.6\linewidth]{Figures/Qubit characterization/Resonator vs DAC linecut.png}
          \caption{Fixed-frequency transmission versus DAC current. The frequency is chosen to be slightly below the resonator frequency, found when the DAC current is set to zero. The symmetry point in the linecut corresponds to the sweet spot of the ancilla qubit.}
          \label{fig:resonator vs dac linecut}
        \end{figure}

        As explained in Sec.~\ref{Scan for qubit sweet spots}, the sweet spot of a qubit can be found by performing a series of resonator scans while varying the DAC current. There is, however, a faster approach for finding the qubit sweet spot, at the cost of providing less information. This is done by choosing a fixed frequency close to the resonator  frequency $\wres$ (preferably slightly below, where the transmission slope is steepest). By measuring the amount of transmission as the DAC voltage is being varied, one essentially obtains a linecut of the 2D scan. The idea this measurement is that if the qubit frequency $\fqub$ decreases, so does resonator frequency, resulting in a decrease in transmission (closer to $\wres$). Likewise, if the qubit frequency $\wqub$ increases, so does the resonator frequency, resulting in an increase in transmission (further away from $\wres$).

        At the qubit's sweet-spot, the resonator's frequency $\wres$ is at a maximum, and so the transmission should also be at a maximum. Furthermore, because the qubit frequency is symmetric with respect to its sweet spot, so should the transmission. The sweet spot can therefore be determined by finding the symmetric point in the transmission. In Fig.~\ref{fig:resonator vs dac linecut} one such linecut is shown. The transmission is clearly symmetric, and the symmetric point is equal to the qubit sweet spot.

        If the resonator's frequency $\wres$ shifts by a large amount in the course of this measurement, it becomes harder to determine where the sweet spot is (although even then often it can still be discerned). Nevertheless, this method is considerably faster than performing a full two-dimensional scan of frequency versus DAC voltage, and in most cases does provide sufficient information to determine the sweet spot.


      \subsubsection{Spectroscopy}
        \begin{itemize}
          \item If the deviation in transmission becomes less due to more detuning, increasing the power can also increase the contrast.
        \end{itemize}
      \subsubsection{Flux matrix}
        After determining the flux matrix $\boldsymbol{F}$, there will still be some small remaining cross coupling, which depends on the accuracy of the measurements. The process of creating a flux matrix can then be repeated, but instead of using DAC voltages as the varying parameters to construct matrix $\boldsymbol{M}$, the virtual fluxes should be used. Furthermore, as the cross-coupling is small compared to before, the flux range can be much greater, such that small slopes can be accurately measured. The resulting flux matrix $\boldsymbol{F}_2$ can then simply be multiplied with the first flux matrix $\boldsymbol{F}$ to obtain a more accurate final flux matrix.
    \chapter{AllXY pulse sequence}
      \label{ch:AllXY pulse table}

      \begin{table}[h]
        \centering
        \begin{tabular}{c c c c }
          \toprule
          number & ideal $\left<z\right>$ & First pulse & Second pulse \\
          \midrule
          1  & 1  & $I$         & $I$         \\
          2  & 1  & $X_\pi$     & $X_\pi$     \\
          3  & 1  & $Y_\pi$     & $Y_\pi$     \\
          4  & 1  & $X_\pi$     & $Y_\pi$     \\
          5  & 1  & $Y_\pi$     & $X_\pi$     \\
          6  & 0  & $X_{\pi/2}$ & $I$         \\
          7  & 0  & $Y_{\pi/2}$ & $I$         \\
          8  & 0  & $X_{\pi/2}$ & $Y_{\pi/2}$ \\
          9  & 0  & $Y_{\pi/2}$ & $X_{\pi/2}$ \\
          10 & 0  & $X_{\pi/2}$ & $Y_\pi$     \\
          11 & 0  & $Y_{\pi/2}$ & $X_\pi$     \\
          12 & 0  & $Y_\pi$     & $Y_{\pi/2}$ \\
          13 & 0  & $X_\pi$     & $X_{\pi/2}$ \\
          14 & 0  & $X_{\pi/2}$ & $X_\pi$     \\
          15 & 0  & $X_\pi$     & $X_{\pi/2}$ \\
          16 & 0  & $Y_{\pi/2}$ & $Y_\pi$     \\
          17 & 0  & $Y_\pi$     & $Y_{\pi/2}$ \\
          18 & -1 & $X_\pi$     & $I$         \\
          19 & -1 & $Y_\pi$     & $I$         \\
          20 & -1 & $X_{\pi/2}$ & $X_{\pi/2}$ \\
          21 & -1 & $Y_{\pi/2}$ & $Y_{\pi/2}$ \\
          \bottomrule
        \end{tabular}
        \caption{The 21 pulses that comprises the AllXY pulse sequence.}
        \label{tab:AllXY sequence}
      \end{table}

      In Table~\ref{tab:AllXY sequence} the 21 pulse combinations are shown that comprise the AllXY pulse sequence. The AllXY measurement is able to diagnose specific sources contributing to gate errors (see Sec.~\ref{ssec:AllXY}). For a more detailed analysis on the AllXY see Reed's thesis~\cite{Reed}.

  \chapter{Randomized benchmarking}
    \section{Clifford gate decomposition}
      \label{ssec:Clifford gate decomposition}


        \begin{tabular}{c c c }
          \toprule
          Clifford nbr     & gate decomposition & \begin{tabular}{@{}c@{}}5 primitives decomposition \\\noalign{\smallskip} $X_{\pi/2} \quad Y_{\pi/2} \quad X_{\pi/2} \quad X_{-\pi} \quad Y_{-\pi}$ \end{tabular}\\
          \midrule
          1 & $ I$ & 0\quad\quad\;0\quad\quad\;0\quad\quad\;0\quad\quad\;0 \\
          2 & $ Y_{\pi/2} -  X_{\pi/2}$ & 0\quad\quad\;1\quad\quad\;1\quad\quad\;0\quad\quad\;0 \\
          3 & $ X_{-\pi/2} -  Y_{-\pi/2}$ & 1\quad\quad\;1\quad\quad\;0\quad\quad\;1\quad\quad\;0 \\
          4 & $ X_\pi$ & 0\quad\quad\;0\quad\quad\;0\quad\quad\;1\quad\quad\;0 \\
          5 & $ Y_{-\pi/2} -  X_{-\pi/2}$ & 0\quad\quad\;1\quad\quad\;1\quad\quad\;0\quad\quad\;1 \\
          6 & $ X_{\pi/2} -  Y_{-\pi/2}$ & 1\quad\quad\;1\quad\quad\;0\quad\quad\;0\quad\quad\;1 \\
          7 & $ Y_\pi$ & 0\quad\quad\;0\quad\quad\;0\quad\quad\;0\quad\quad\;1 \\
          8 & $ Y_{-\pi/2} -  X_{\pi/2}$ & 0\quad\quad\;1\quad\quad\;1\quad\quad\;1\quad\quad\;1 \\
          9 & $ X_{\pi/2} -  Y_{\pi/2}$ & 1\quad\quad\;1\quad\quad\;0\quad\quad\;0\quad\quad\;0 \\
          10 & $ X_\pi -  Y_\pi$ & 0\quad\quad\;0\quad\quad\;0\quad\quad\;1\quad\quad\;1 \\
          11 & $ Y_{\pi/2} -  X_{-\pi/2}$ & 0\quad\quad\;1\quad\quad\;1\quad\quad\;1\quad\quad\;0 \\
          12 & $ X_{-\pi/2} -  Y_{\pi/2}$ & 1\quad\quad\;1\quad\quad\;0\quad\quad\;1\quad\quad\;1 \\
          13 & $ Y_{\pi/2} -  X_\pi$ & 0\quad\quad\;1\quad\quad\;0\quad\quad\;1\quad\quad\;0 \\
          14 & $ X_{-\pi/2}$ & 0\quad\quad\;0\quad\quad\;1\quad\quad\;1\quad\quad\;0 \\
          15 & $ X_{\pi/2} -  Y_{-\pi/2} -  X_{-\pi/2}$ & 1\quad\quad\;1\quad\quad\;1\quad\quad\;0\quad\quad\;1 \\
          16 & $ Y_{-\pi/2}$ & 0\quad\quad\;1\quad\quad\;0\quad\quad\;0\quad\quad\;1 \\
          17 & $ X_{\pi/2}$ & 0\quad\quad\;0\quad\quad\;1\quad\quad\;0\quad\quad\;0 \\
          18 & $ X_{\pi/2} -  Y_{\pi/2} -  X_{\pi/2}$ & 1\quad\quad\;1\quad\quad\;1\quad\quad\;0\quad\quad\;0 \\
          19 & $ Y_{-\pi/2} -  X_\pi$ & 0\quad\quad\;1\quad\quad\;0\quad\quad\;1\quad\quad\;1 \\
          20 & $ X_{\pi/2} -  Y_\pi$ & 1\quad\quad\;0\quad\quad\;0\quad\quad\;0\quad\quad\;1 \\
          21 & $ X_{\pi/2} -  Y_{-\pi/2} -  X_{\pi/2}$ & 1\quad\quad\;1\quad\quad\;1\quad\quad\;1\quad\quad\;1 \\
          22 & $ Y_{\pi/2}$ & 0\quad\quad\;1\quad\quad\;0\quad\quad\;0\quad\quad\;0 \\
          23 & $ X_{-\pi/2} -  Y_\pi$ & 1\quad\quad\;0\quad\quad\;0\quad\quad\;1\quad\quad\;1 \\
          24 & $ X_{\pi/2} -  Y_{\pi/2} -  X_{-\pi/2}$ & 1\quad\quad\;1\quad\quad\;1\quad\quad\;1\quad\quad\;0 \\
          \bottomrule
        \end{tabular}

      % \begin{figure}[tb]
      %   \centering
      %   \includegraphics[width=\textwidth]{Figures/Clifford decomposition.png}
      %   \caption{Decomposition of all $24$ Cliffords into X and Y rotations}
      %   \label{fig:Clifford decomposition}
      % \end{figure}
      % \textbf{TODO:} Cite


    \section{Determining population in three states}
      \label{ssec:Determining population in three states}
      If there were no leakage present during randomized benchmarking, the full information about the state populations can be extracted from the randomized benchmarking results. However, if leakage to the second-excited state is present, the full information about the populations of the three states can be extracted using two versions of randomized benchmarking, one without a final pi pulse, and one with a final pi pulse. The final pi pulse swaps the populations in the ground and excited state. We assume that the population of the second excited-state remains unaffected by this single final pulse.

      Using these two randomized benchmarking sequences, two different signals $S_0$ and $S_1$ are measured, corresponding to a measurement without a final pi pulse, and a measurement with a final pi pulse, respectively. This leads to the following three equations:

      \begin{align}
        p_0 V_0 + p_1 V_1 + p_2 V_2 = & S_0; \notag\\
        p_1 V_1 + p_0 V_1 + p_2 V_2 = & S_1; \notag\\
        p_0 + p_1 + p_2 = &   1,
        \label{eq:three populations equations App}
      \end{align}
      where $p_i$ corresponds to the final population in state $\ket{i}$, and $V_i$ is the signal of state $\ket{i}$. Filling in $p_2 = 1 - p_0 - p_1$ into the first two equations of \ref{eq:three populations equations App}, we are left with the following set of equations:

      \begin{align}
        \begin{bmatrix}
          V_0 - V_2 & V_1 - V_2 \\
          V_1 - V_2 & V_0 - V_2
        \end{bmatrix}
        \begin{bmatrix}
          p_0 \\
          p_1
        \end{bmatrix}
        =
        \begin{bmatrix}
          S_0 - V_2 \\
          S_1 - V_2
        \end{bmatrix}.
      \end{align}
      This set of equations can be easily solved by matrix inversion, resulting in the following three populations:

      \begin{align}
        \begin{bmatrix}
          p_0 \\
          p_1
        \end{bmatrix}
        = &
        \left((V_0-V_2)^2 - (V_1 - V_2)^2\right)^{-1}
        \begin{bmatrix}
          V_0 - V_2 & -V_1 + V_2 \\
          -V_1 + V_2 & V_0 + V_2
        \end{bmatrix}
        \begin{bmatrix}
          S_0 - V_2 \\
          S_1 - V_2
        \end{bmatrix}; \notag\\
        p_2 = & 1 - p_0 - p_1.
        \label{eq:RB populations using final pi}
      \end{align}
      If one has knowledge of all thee signals $V_0$, $V_1$ and $V_2$ (see Sec.~\ref{ssec:Second excited-state} for information on measuring $V_2$), the three populations can be obtained using Eq.~\ref{eq:RB populations using final pi}.
      \newpage
  \section{Two-qubit randomized benchmarking leakage}
    \label{sec:Two-qubit randomized benchmarking leakage}
        \begin{table}[h]
          \begin{tabular}{c c c c c}
            \toprule
            RB mode & \multicolumn{2}{c}{Top qubit} & \multicolumn{2}{c}{Bottom qubit} \\
            \cmidrule(lr){2-3}
            \cmidrule(lr){4-5}
            & $T_1^2 (\mu s)$ & $\alpha$ (\%) & $T_1^2$ $(\mu s)$ & $\alpha$ (\%) \\
            \midrule
            Alternating  & $10.0(6)$    & $0.027(1)$ & $4.9(1.9)$  & $0.011(5)$\\
            Compiled     & $8.8(6)$    & $0.024(1)$  & $4.5(9)$ & $0.011(2)$\\
            5 primitives &$9.7(7)$    & $0.038(3)$  & $4.9(1)$  & $0.018(5)$\\
            \bottomrule
          \end{tabular}
        \end{table}


        \begin{figure}[h]
          \centering
          \includegraphics[width=\textwidth]{Figures/Randomized benchmarking/2nd-state leakage 2Q.png}
          \caption{Second-excited-state leakage along with fit using Eq.~\ref{eq:2nd state formula}.}
          \label{fig:second state leakage 2Q}
        \end{figure}

\chapter{Compiled randomized benchmarking algorithm}
  \label{sec:compiled randomized benchmarking algorithm}
  \section{Finding the optimal gate sequence}
    In compiled randomized benchmarking, every combination of $n$ Cliffords, each applied to one of the $n$ qubits, is compiled to minimize the total number of pulses sent. This compilation is done by comparing all possible decompositions for each Clifford in the set of Cliffords with each other, and determining the combination that results in the least number of total pulses. The constraint is that distinct pulses may not be applied simultaneously. Any one pulse may, however, can be directed to any subset of the $n$ qubits.

    Given $n$ Cliffords $\left(C_{\alpha_1}^1, \dots, C_{\alpha_n}^n\right)$, where $\alpha_i$ is the Clifford id for qubit $i$, a particular decomposition of the Cliffords is given by $\left(\left( P_1^1, ..., P_{m_1}^1 \right) , ..., \left(P_1^n, ..., P_{m_n}^n\right)\right)$, where $m_i$ is the number of pulses in the decomposition of Clifford $C_{\alpha_i}^i$, and $P_j^i$ is pulse $j$ of the Clifford decomposition of $C_i$. Our algorithm for finding the minimum number of pulses for a particular combination of Clifford decompositions is recursive. It determines all possible ways in which the pulses can be ordered, and chooses the one with the lowest total number of pulses.

    To explain this algorithm, let us denote $\bm{\beta}=\left(\beta_1, \dots, \beta_n\right)$ as the indices of the next possible pulses. The corresponding pulses are given by $\bm{P_\bm{\beta}}=\left( P_{\beta_1}^1, \dots, P_{\beta_n}^n \right)$. For the indices where $\beta_i=m_i + 1$, there is no next pulse, and so $P_{\beta_i}$ does not exist and should not be added to $\bm{P_\bm{\beta}}$. The algorithm operates as follows:

    \begin{enumerate}
      \item Start with an empty sequence of pulses $P_\text{seq}$ and pulse indices $\bm{\beta} = \left(\beta_1, ..., \beta_n\right) = \left(1, ..., 1\right)$;
      \item Determine the set of distinct pulses in $P_{\bm{\beta}}$;
      \item For each pulse $p$ in the set of distinct pulses, perform the following steps:
      \begin{enumerate}
        \item Append $P$ to $P_\text{seq}$;
        \item Determine all indices $i$ for which the next pulse $P_{\beta_i}^i$ equals $p$;
        \item Copy pulse indices $\bm{\beta}$ to $\bm{\beta}^\text{new}=\left(\beta_1^\text{new}, ..., \beta_n^\text{new}\right)=\left(\beta_1, ..., \beta_n\right)$;
        \item For all indices $i$ for which $P_{\beta_i}^i=g$, increase the pulse index $\beta_i^\text{new} = \beta_i+1$;
        \item Go to step 2 using the new pulse indices $\bm{\beta}^\text{new}$;
      \end{enumerate}
      \item If $P_{\bm{\beta}}$ is empty, then $P_\text{seq}$ is a particular sequence of pulses that would result in all Cliffords being applied to the corresponding qubits;
      \item When all possible sequences are combined, choose the sequence with the minimum number of pulses in $P_\text{seq}$.
    \end{enumerate}

    This algorithm determines the least number of pulses necessary to perform all Cliffords in one particular combination of decompositions. However, each Clifford has on average $38$ different decompositions, and so for $n$ qubits the total decomposition combinations is approximately $38^n$, meaning that this algorithm would have to be repeated $38^n$ times to find the global minimum. In fact, this would only determine the optimal compilation for one particular set of Cliffords; to find the average number of pulses per Clifford combination, one would have to average over all $24^n$ possible combinations of Cliffords. This problem therefore scales exponentially with the number of qubits, and would seem computationally challenging for as few as $n=5$ qubits, as it would require $24^5\cdot38^5=6.3\cdot10^14$ different decomposition combinations. Nevertheless we have exactly calculated the average number of pulses per Clifford for up to $n=5$ qubits. To do this, we employed several optimizations that are discussed below.

  \section{Optimizing the gate compilation algorithm}
    \label{Optimizing the gate compilation algorithm}

    The first and simplest optimization is from the observation that the optimal gate compilation for a certain combination of Cliffords $\left(C_{\alpha_1}^1, \dots, C_{\alpha_n}^n\right)$ is the same as any permutation of those Cliffords. We therefore only need to determine the optimal compilations for the combinations $\left(C_{\beta_1}^1, \dots, C_{\beta_n}^n\right)$ where $\beta_1 \leq \beta_2 \leq \dots \leq \beta_n$. This already reduces the number of calculations exponentially ($81$ times less computations when $n=5$).

    The second optimization is to keep track of the minimum number of pulses found so far that can compile a given combination of Cliffords. At each stage, the algorithm checks if the sum of the pulses in $P_\text{seq}$ and all distinct pulses left in $P_{\bm{\beta}}$ is equal to or greater than the minimum number of pulses found so far. If this is the case, it knows that a shorter combination of pulses using $G_\text{seq}$ is not possible. It can therefore stops considering this sequence and proceeds to the one. The minimum number of pulses can initially be placed at $5$ pulses, as the $5$-primitives method proves that there is always a decomposition of an arbitrary number of Cliffords into $5$ pulses. Note that, as the minimum number of pulses decreases, the frequency at which the algorithm stops considering sequences increases.

    The third optimization relies on the fact that it is more likely that decompositions with fewer pulses result in an optimal pulses compilation. The decompositions of all Cliffords have therefore been arranged in ascending number of pulses. When comparing the decompositions of the Cliffords, the first decompositions compared are those with the fewest pulses. The probability of finding the optimal gate compilation is therefore high; even if it did not find the optimal gate compilation, it is likely that the minimum pulse length found so far will be low. This optimization is especially effective in combination with the second optimization.

    The fourth optimization places a lower bound on the number of pulses. For a given combination of Cliffords $\left(C_{\alpha_1}^1, \dots, C_{\alpha_n}^n\right)$, the lower bound is found by looking at the optimal lengths previously found for all $n-1$ Clifford subsets. This requires knowledge of the lengths of all the $n-1$ Cliffords. Since the length of the $n$ Cliffords can never be less than any of the lengths of the $n-1$ Clifford subsets, the maximum of these lengths therefore places a lower bound on the optimal number of pulses. This means that if ever during the algorithm a sequence of pulses for any tuple of decompositions is found whose length is equal to this lower bound, it will know it has found the optimal gate compilation for the tuple of Cliffords, and may abort all further search. This is in contrast to the second optimization, where an upper bound was found, in which case only the particular sequence of pulses could be aborted. As $n$ increases, it becomes increasingly likely that the lower bound is equal to 5. In this case, the lower bound is equal to the upper bound set by the $5$-primitives method, and so it can immediately be concluded that the $5$-primitives method provides an optimal gate compilation. This optimization results in a largest gain in computation time, by several orders of magnitude.

    The fifth, and most complicated, optimization, is based on separating all decompositions with three pulses or less from those composed of four pulses. First, all combinations are tested using only decompositions with three or less pulses. This greatly reduces the average number of decompositions per Clifford, from $38$ to $7$. Especially as the number of qubits increases, this results in fewer total comparisons. It is not always the case that the minimum number of pulses is found using only up to three pulses per decomposition; sometimes the optimal gate compilation requires one of the decompositions to have four pulses. We, however, only need to include four-pulse decompositions when the lower bound is four or less, and when the minimum gate compilation found using only three pulses or less is equal to five or more. Only in this case could there be a four-pulse decomposition that could outperform pulse decompositions with only three pulses or less. We furthermore know that if there is such a four-pulse decomposition that results in the optimal gate compilation, its length must be equal to four, as the 5-primitives method places the upper bound at 5 pulses. We therefore also know that only one Clifford can have a four-pulse decomposition, and all other Cliffords must be subsets of these four pulses. We can therefore loop over each of the four-pulse decompositions, and test whether all other Cliffords are subsets of these four pulses. This changes the four-pulse comparison from scaling exponentially with $n$ to scaling linearly.

    \begin{table}
      \begin{tabular}{c c || c c}
        \toprule
        number of qubits  & average gates per Clifford & number of qubits  & average gates per Clifford \\
        \midrule
        1 & 1.875 & 6  & 4.380 (12)\\
        2 & 2.925 & 7  & 4.570 (15)\\
        3 & 3.521 & 8  & 4.721 (10)\\
        4 & 3.874 & 9  & 4.808 (14)\\
        5 & 4.137 & 10 & 4.857 (24)\\
        \bottomrule
      \end{tabular}
      \caption{The average gates per Clifford after compilation. Values up to $n=5$ have been calculated exact, while values starting from $n=6$ have been determined using random sampling.}
      \label{tab:gates per Clifford}
    \end{table}

    Using these five optimizations, we have calculated the average gates per Clifford tuple exactly for $n=5$ qubits within two hours. Furthermore, the average gates per Clifford has been approximated for up to $n=10$ Cliffords using random sampling. The results are shown in Table~\ref{tab:gates per Clifford}.
