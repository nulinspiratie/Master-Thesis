%!TEX root = ../thesis.tex
\input{noise.tex}

\externaldocument[A-]{Chapters/DRIE.tex}
\externaldocument[A-]{Chapters/Muxmon.tex}

\chapter{Photon number calculation}
  \label{ch:photon number calculation}

  In cQED resonators usually operate in the single-photon regime. It is therefore important to know what power is required to reach this regime. In the equilibrium state of the resonator the power absorbed $P_\text{abs}$ by the resonator is equal to the power leaking out of the resonator, and so the absorbed power $P_\text{abs}$ can be expressed as

  \begin{equation}
    P_\text{abs} = \left<n_\text{ph}\right>\hbar\omega_r \kappa,
    \label{eq:Pabs-nph}
  \end{equation}
  where $\kappa=\omega_r/Q_i$ is the cavity decay rate.

  The absorbed power $P_\text{abs}$ can also be expressed in terms of the input power $P_\text{in}$ entering the feedline. We note that the absorbed power $P_\text{abs}$ is equal to the input power $P_\text{in}$ entering the feedline minus the reflected power $P_\text{refl}$ and the transmitted power $P_\text{trans}$. These are given by

  \begin{align}
    P_\text{refl} = P_\text{in}\left|S_{11}\right|^2;\\
    P_\text{trans} = P_\text{in}\left|S_{21}\right|^2,
  \end{align}
  where $S_{11}$ and $S_{21}$ are the scattering parameters. At the resonance frequency $S_{21}=\frac{Q_c}{Q_i+Q_c}$ (see Eq.~\ref{eq:S21min}), and $S_{11}=S_{21}-1$. Therefore the absorbed power is equal to

  \begin{equation}
    P_\text{abs}=1-P_\text{refl}-P_\text{trans}=\frac{2Q_l^2}{Q_c Q_i}P_\text{in}.
    \label{Pabs-Pin}
  \end{equation}
  Combining Eqs.~\ref{eq:Pabs-nph} and~\ref{Pabs-Pin}, we arrive at a formula for the mean photon number $\left<n_\text{ph}\right>$:

  \begin{equation}
    \left<n_\text{ph}\right> = \frac{2}{\hbar \omega_r}\frac{Q_l^2}{Q_c}P_\text{in}.
  \end{equation}
  The input power $P_\text{in}$ can be found by measuring the transmission of the components between the generator and feedline.



\chapter{Duplexer isolation}
  \label{ch:Duplexer isolation}

  \begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{Figures/Appendix/Duplexer isolation.png}
    \caption{Isolation of the Duplexer. Legend indices correspond to switch state ($1$ means open, $0$ means closed, lsb corresponds to bottom drive line, msb to top drive line). Transmission is measured relative to the transmission when all channels are open (11). The black line corresponds to the measured noise floor. The red-dashed line indicates the frequency of the top and bottom qubit, and the blue-dashed line to the ancilla qubit, during the Muxmon experiment.}
    \label{fig:Duplexer isolation}
  \end{figure}

  The isolation of the Duplexer switches has been measured. During the measurements a signal was sent through input channel $1$ and $2$, corresponding to the signal of the main Gaussian pulse, and derivative pulse, respectively. For each input channel the transmission to each of the two output channels has been measured. These output channels are connected to the drive lines of the top and bottom qubit during the Muxmon experiment. For each input-output-port combination the transmission has been measured for different switch configurations, which were controlled using the nanosecond switches. Four different switch combinations were used, corresponding the the four distinct possibilities of the signal being directed to each of the two output channels.

  The results of the isolation measurements are shown in Fig.~\ref{fig:Duplexer isolation}. As can be seen in all four input-output combinations the isolation is around \SI{50}{\dBm} at the frequency of top and bottom qubit. Furthermore, the isolation does not seem to depend strongly on whether the switch to the other output port is open or closed.

\chapter{Chip characterization}

  \section{Muxmon1 cross-driving}
    \label{sec:Muxmon1 cross-driving}
      \begin{table}[h]
        \begin{tabular}{l c c}
          \toprule
          qubit & \multicolumn{2}{c}{cross-driving (\%)} \\
          \cmidrule(lr){2-3}
               & top-ancilla drive line & bottom-ancilla drive line \\
          \midrule
          Top     & $100$    & $5.22$ \\
          Ancilla & $75$ & $62.5$ \\
          Bottom  & $1.05$ & $100$    \\
          \bottomrule
        \end{tabular}
        \label{tab:Muxmon1 cross-driving}
      \end{table}

  \section{Muxmon0 resonator buses}
    \label{sec:Resonator buses}

    \begin{figure}[h]
      \centering
      \includegraphics[width=\textwidth]{Figures/Appendix/resonator buses.png}
      \caption{Normalized transmission showing the resonator buses of the top and bottom qubit, at frequencies \SI{4.88}{\giga \hertz} and \SI{4.97}{\giga \hertz}, respectively.}
      \label{fig:resonator buses}
    \end{figure}

    The top and bottom qubit are each coupled to a resonator bus. When the frequency of a qubit approaches that of the bus, they experience an avoided crossing. In Fig.~\ref{fig:resonator buses} these avoided crossing are shown for the top and bottom qubit. For the top qubit the frequency of the resonator bus is found to be \SI{4.88}{\giga \hertz}. For the bottom qubit the signal was considerably worse, but the frequency of the resonator bus is found to be roughly \SI{4.97}{\giga \hertz}. For the top qubit the coupling strength $g$ between the qubit and the bus can be extracted. It is equal to half the minimum distance, and approximately equal to \SI{27}{\mega \hertz}.

\chapter{Additional notes}
  \section{Qubit characterization}
      \subsection{Finding the qubit sweet spot using a one-dimensional scan}
        \label{Finding the qubit sweet spot using a one-dimensional scan}
        \begin{figure}[tb]
          \centering
          \includegraphics[width=.6\linewidth]{Figures/Qubit characterization/Resonator vs DAC linecut.png}
          \caption{Fixed-frequency transmission versus DAC current. The frequency is chosen to be slightly below the resonator frequency, found when the DAC current is set to zero. The symmetry point in the linecut corresponds to the sweet spot of the ancilla qubit.}
          \label{fig:resonator vs dac linecut}
        \end{figure}

        As explained in Sec.~\ref{Scan for qubit sweet spots}, the sweet spot of a qubit can be found by performing a series of resonator scans while varying the DAC current. There is, however, a faster approach for finding the qubit sweet spot, at the cost of providing less information. This is done by choosing a fixed frequency close to the resonator  frequency $\wres$ (preferably slightly below, where the transmission slope is steepest). By measuring the amount of transmission as the DAC voltage is being varied, one essentially obtains a linecut of the 2D scan. The idea this measurement is that if the qubit frequency $\fqub$ decreases, so does resonator frequency, resulting in a decrease in transmission (closer to $\wres$). Likewise, if the qubit frequency $\wqub$ increases, so does the resonator frequency, resulting in an increase in transmission (further away from $\wres$).

        At the qubit's sweet-spot, the resonator's frequency $\wres$ is at a maximum, and so the transmission should also be at a maximum. Furthermore, because the qubit frequency is symmetric with respect to its sweet spot, so should the transmission. The sweet spot can therefore be determined by finding the symmetric point in the transmission. In Fig.~\ref{fig:resonator vs dac linecut} one such linecut is shown. The transmission is clearly symmetric, and the symmetric point is equal to the qubit sweet spot.

        If the resonator's frequency $\wres$ shifts by a large amount in the course of this measurement, it becomes harder to determine where the sweet spot is (although even then often it can still be discerned). Nevertheless, this method is considerably faster than performing a full two-dimensional scan of frequency versus DAC voltage, and in most cases does provide sufficient information to determine the sweet spot.


      \subsubsection{Spectroscopy}
        \begin{itemize}
          \item If the deviation in transmission becomes less due to more detuning, increasing the power can also increase the contrast.
        \end{itemize}
      \subsubsection{Flux matrix}
        After determining the flux matrix $\boldsymbol{F}$, there will still be some small remaining cross coupling, which depends on the accuracy of the measurements. The process of creating a flux matrix can then be repeated, but instead of using DAC voltages as the varying parameters to construct matrix $\boldsymbol{M}$, the virtual fluxes should be used. Furthermore, as the cross-coupling is small compared to before, the flux range can be much greater, such that small slopes can be accurately measured. The resulting flux matrix $\boldsymbol{F}_2$ can then simply be multiplied with the first flux matrix $\boldsymbol{F}$ to obtain a more accurate final flux matrix.
    \chapter{AllXY pulse sequence}
      \label{ch:AllXY pulse table}

      \begin{table}[h]
        \centering
        \begin{tabular}{c c c c }
          \toprule
          number & ideal $\left<z\right>$ & First pulse & Second pulse \\
          \midrule
          1  & 1  & $I$         & $I$         \\
          2  & 1  & $X_\pi$     & $X_\pi$     \\
          3  & 1  & $Y_\pi$     & $Y_\pi$     \\
          4  & 1  & $X_\pi$     & $Y_\pi$     \\
          5  & 1  & $Y_\pi$     & $X_\pi$     \\
          6  & 0  & $X_{\pi/2}$ & $I$         \\
          7  & 0  & $Y_{\pi/2}$ & $I$         \\
          8  & 0  & $X_{\pi/2}$ & $Y_{\pi/2}$ \\
          9  & 0  & $Y_{\pi/2}$ & $X_{\pi/2}$ \\
          10 & 0  & $X_{\pi/2}$ & $Y_\pi$     \\
          11 & 0  & $Y_{\pi/2}$ & $X_\pi$     \\
          12 & 0  & $Y_\pi$     & $Y_{\pi/2}$ \\
          13 & 0  & $X_\pi$     & $X_{\pi/2}$ \\
          14 & 0  & $X_{\pi/2}$ & $X_\pi$     \\
          15 & 0  & $X_\pi$     & $X_{\pi/2}$ \\
          16 & 0  & $Y_{\pi/2}$ & $Y_\pi$     \\
          17 & 0  & $Y_\pi$     & $Y_{\pi/2}$ \\
          18 & -1 & $X_\pi$     & $I$         \\
          19 & -1 & $Y_\pi$     & $I$         \\
          20 & -1 & $X_{\pi/2}$ & $X_{\pi/2}$ \\
          21 & -1 & $Y_{\pi/2}$ & $Y_{\pi/2}$ \\
          \bottomrule
        \end{tabular}
        \caption{The 21 pulses that comprises the AllXY pulse sequence.}
        \label{tab:AllXY sequence}
      \end{table}

      In Table~\ref{tab:AllXY sequence} the 21 pulse combinations are shown that comprise the AllXY pulse sequence. The AllXY measurement is able to diagnose specific sources contributing to gate errors (see Sec.~\ref{ssec:AllXY}). For a more detailed analysis on the AllXY see Reed's thesis~\cite{Reed}.

  \chapter{Randomized benchmarking}
    \section{Clifford gate decomposition}
      \label{ssec:Clifford gate decomposition}


        \begin{tabular}{c c c }
          \toprule
          Clifford ID     & gate decomposition & \begin{tabular}{@{}c@{}}5 primitives decomposition \\\noalign{\smallskip} $X_{\pi/2} \quad Y_{\pi/2} \quad X_{\pi/2} \quad X_{-\pi} \quad Y_{-\pi}$ \end{tabular}\\
          \midrule
          1 & $ I$ & 0\quad\quad\;0\quad\quad\;0\quad\quad\;0\quad\quad\;0 \\
          2 & $ Y_{\pi/2} -  X_{\pi/2}$ & 0\quad\quad\;1\quad\quad\;1\quad\quad\;0\quad\quad\;0 \\
          3 & $ X_{-\pi/2} -  Y_{-\pi/2}$ & 1\quad\quad\;1\quad\quad\;0\quad\quad\;1\quad\quad\;0 \\
          4 & $ X_\pi$ & 0\quad\quad\;0\quad\quad\;0\quad\quad\;1\quad\quad\;0 \\
          5 & $ Y_{-\pi/2} -  X_{-\pi/2}$ & 0\quad\quad\;1\quad\quad\;1\quad\quad\;0\quad\quad\;1 \\
          6 & $ X_{\pi/2} -  Y_{-\pi/2}$ & 1\quad\quad\;1\quad\quad\;0\quad\quad\;0\quad\quad\;1 \\
          7 & $ Y_\pi$ & 0\quad\quad\;0\quad\quad\;0\quad\quad\;0\quad\quad\;1 \\
          8 & $ Y_{-\pi/2} -  X_{\pi/2}$ & 0\quad\quad\;1\quad\quad\;1\quad\quad\;1\quad\quad\;1 \\
          9 & $ X_{\pi/2} -  Y_{\pi/2}$ & 1\quad\quad\;1\quad\quad\;0\quad\quad\;0\quad\quad\;0 \\
          10 & $ X_\pi -  Y_\pi$ & 0\quad\quad\;0\quad\quad\;0\quad\quad\;1\quad\quad\;1 \\
          11 & $ Y_{\pi/2} -  X_{-\pi/2}$ & 0\quad\quad\;1\quad\quad\;1\quad\quad\;1\quad\quad\;0 \\
          12 & $ X_{-\pi/2} -  Y_{\pi/2}$ & 1\quad\quad\;1\quad\quad\;0\quad\quad\;1\quad\quad\;1 \\
          13 & $ Y_{\pi/2} -  X_\pi$ & 0\quad\quad\;1\quad\quad\;0\quad\quad\;1\quad\quad\;0 \\
          14 & $ X_{-\pi/2}$ & 0\quad\quad\;0\quad\quad\;1\quad\quad\;1\quad\quad\;0 \\
          15 & $ X_{\pi/2} -  Y_{-\pi/2} -  X_{-\pi/2}$ & 1\quad\quad\;1\quad\quad\;1\quad\quad\;0\quad\quad\;1 \\
          16 & $ Y_{-\pi/2}$ & 0\quad\quad\;1\quad\quad\;0\quad\quad\;0\quad\quad\;1 \\
          17 & $ X_{\pi/2}$ & 0\quad\quad\;0\quad\quad\;1\quad\quad\;0\quad\quad\;0 \\
          18 & $ X_{\pi/2} -  Y_{\pi/2} -  X_{\pi/2}$ & 1\quad\quad\;1\quad\quad\;1\quad\quad\;0\quad\quad\;0 \\
          19 & $ Y_{-\pi/2} -  X_\pi$ & 0\quad\quad\;1\quad\quad\;0\quad\quad\;1\quad\quad\;1 \\
          20 & $ X_{\pi/2} -  Y_\pi$ & 1\quad\quad\;0\quad\quad\;0\quad\quad\;0\quad\quad\;1 \\
          21 & $ X_{\pi/2} -  Y_{-\pi/2} -  X_{\pi/2}$ & 1\quad\quad\;1\quad\quad\;1\quad\quad\;1\quad\quad\;1 \\
          22 & $ Y_{\pi/2}$ & 0\quad\quad\;1\quad\quad\;0\quad\quad\;0\quad\quad\;0 \\
          23 & $ X_{-\pi/2} -  Y_\pi$ & 1\quad\quad\;0\quad\quad\;0\quad\quad\;1\quad\quad\;1 \\
          24 & $ X_{\pi/2} -  Y_{\pi/2} -  X_{-\pi/2}$ & 1\quad\quad\;1\quad\quad\;1\quad\quad\;1\quad\quad\;0 \\
          \bottomrule
        \end{tabular}

      % \begin{figure}[tb]
      %   \centering
      %   \includegraphics[width=\textwidth]{Figures/Clifford decomposition.png}
      %   \caption{Decomposition of all $24$ Cliffords into X and Y rotations}
      %   \label{fig:Clifford decomposition}
      % \end{figure}
      % \textbf{TODO:} Cite


    \section{Determining population in three states}
      \label{ssec:Determining population in three states}
      If there were no leakage present during randomized benchmarking, the full information about the state populations can be extracted from the randomized benchmarking results. However, if leakage to the second-excited state is present, the full information about the populations of the three states can be extracted using two versions of randomized benchmarking, one without a final pi pulse, and one with a final pi pulse. The final pi pulse swaps the populations in the ground and excited state. We assume that the population of the second excited-state remains unaffected by this single final pulse.

      Using these two randomized benchmarking sequences, two different signals $S_0$ and $S_1$ are measured, corresponding to a measurement without a final pi pulse, and a measurement with a final pi pulse, respectively. This leads to the following three equations:

      \begin{align}
        p_0 V_0 + p_1 V_1 + p_2 V_2 = & S_0; \notag\\
        p_1 V_1 + p_0 V_1 + p_2 V_2 = & S_1; \notag\\
        p_0 + p_1 + p_2 = &   1,
        \label{eq:three populations equations App}
      \end{align}
      where $p_i$ corresponds to the final population in state $\ket{i}$, and $V_i$ is the signal of state $\ket{i}$. Filling in $p_2 = 1 - p_0 - p_1$ into the first two equations of \ref{eq:three populations equations App}, we are left with the following set of equations:

      \begin{align}
        \begin{bmatrix}
          V_0 - V_2 & V_1 - V_2 \\
          V_1 - V_2 & V_0 - V_2
        \end{bmatrix}
        \begin{bmatrix}
          p_0 \\
          p_1
        \end{bmatrix}
        =
        \begin{bmatrix}
          S_0 - V_2 \\
          S_1 - V_2
        \end{bmatrix}.
      \end{align}
      This set of equations can be easily solved by matrix inversion, resulting in the following three populations:

      \begin{align}
        \begin{bmatrix}
          p_0 \\
          p_1
        \end{bmatrix}
        = &
        \left((V_0-V_2)^2 - (V_1 - V_2)^2\right)^{-1}
        \begin{bmatrix}
          V_0 - V_2 & -V_1 + V_2 \\
          -V_1 + V_2 & V_0 + V_2
        \end{bmatrix}
        \begin{bmatrix}
          S_0 - V_2 \\
          S_1 - V_2
        \end{bmatrix}; \notag\\
        p_2 = & 1 - p_0 - p_1.
        \label{eq:RB populations using final pi}
      \end{align}
      If one has knowledge of all thee signals $V_0$, $V_1$ and $V_2$ (see Sec.~\ref{ssec:Second excited-state} for information on measuring $V_2$), the three populations can be obtained using Eq.~\ref{eq:RB populations using final pi}.
      \newpage
  \section{Two-qubit randomized benchmarking leakage}
    \label{sec:Two-qubit randomized benchmarking leakage}
        \begin{table}[h]
          \begin{tabular}{c c c c c}
            \toprule
            RB mode & \multicolumn{2}{c}{Top qubit} & \multicolumn{2}{c}{Bottom qubit} \\
            \cmidrule(lr){2-3}
            \cmidrule(lr){4-5}
            & $T_1^2 (\mu s)$ & $\alpha$ (\%) & $T_1^2$ $(\mu s)$ & $\alpha$ (\%) \\
            \midrule
            Alternating  & $10.0(6)$    & $0.027(1)$ & $4.9(1.9)$  & $0.011(5)$\\
            Compiled     & $8.8(6)$    & $0.024(1)$  & $4.5(9)$ & $0.011(2)$\\
            5 primitives &$9.7(7)$    & $0.038(3)$  & $4.9(1)$  & $0.018(5)$\\
            \bottomrule
          \end{tabular}
        \end{table}


        \begin{figure}[h]
          \centering
          \includegraphics[width=\textwidth]{Figures/Randomized benchmarking/2nd-state leakage 2Q.png}
          \caption{Second-excited-state leakage along with fit using Eq.~\ref{eq:2nd state formula}.}
          \label{fig:second state leakage 2Q}
        \end{figure}

\chapter{Compiled randomized benchmarking algorithm}
  \label{sec:compiled randomized benchmarking algorithm}
  \section{Finding the optimal pulse sequence}
    In compiled randomized benchmarking, every combination of $n$ Cliffords, each applied to a separate qubit, is compiled to minimize the total number of pulses. The constraint is that distinct pulses may not be applied simultaneously. Any one pulse may, however, can be directed to any subset of the $n$ qubits. The compilation is done by comparing all possible pulse decompositions for each of the $n$ Cliffords with each other, and determining the sequence of pulses that results in the minimum number of total pulses.

    Our algorithm for finding the minimum number of pulses for a particular combination of Clifford decompositions is recursive. It determines all possible ways in which the pulses can be ordered, and chooses the one with the minimum number of pulses. Given $n$ Cliffords $\left(C_{\alpha_1}, \dots, C_{\alpha_n}\right)$, where $\alpha_i$ is the Clifford ID for qubit $i$, a particular combination of Clifford decompositions is given by $\left(\left( P_1^1, ..., P_{m_1}^1 \right) , ..., \left(P_1^n, ..., P_{m_n}^n\right)\right)$, where $m_i$ is the number of pulses in the decomposition of Clifford $C_{\alpha_i}$, and $P_j^i$ is pulse $j$ of the particular decomposition of $C_i$. To explain this algorithm, let us denote $\bm{\beta}=\left(\beta_1, \dots, \beta_n\right)$ as the indices of the next possible pulses in the decompositions, with corresponding pulses $\bm{P_\bm{\beta}}=\left( P_{\beta_1}^1, \dots, P_{\beta_n}^n \right)$. For the indices where $\beta_i=m_i + 1$, there is no next pulse, and so $P_{\beta_i}$ does not exist, and should therefore not be added to $\bm{P_\bm{\beta}}$. The algorithm operates as follows:

    \begin{enumerate}
      \item Start with an empty sequence of pulses $P_\text{seq}$ and pulse indices $\bm{\beta} = \left(\beta_1, ..., \beta_n\right) = \left(1, ..., 1\right)$;
      \item Determine the set of distinct pulses in $P_{\bm{\beta}}$;
      \item For each pulse $P$ in $P_{\bm{\beta}}$, perform the following steps:
      \begin{enumerate}
        \item Append $P$ to $P_\text{seq}$;
        \item Copy pulse indices $\bm{\beta}$ to $\bm{\beta}^\text{new}=\left(\beta_1^\text{new}, ..., \beta_n^\text{new}\right)$;
        \item For all indices $i$ for which $P_{\beta_i}^i=P$, increase the pulse index $\beta_i^\text{new} = \beta_i+1$;
        \item Go to step 2 using the new pulse indices $\bm{\beta} \rightarrow \bm{\beta}^\text{new}$;
      \end{enumerate}
      \item When $P_{\bm{\beta}}$ is empty, $P_\text{seq}$ is a particular sequence of pulses such that all Cliffords are applied to the corresponding qubits;
      \item After considering all possible pulse sequences, choose the sequence with the minimum number of pulses in $P_\text{seq}$.
    \end{enumerate}

    This algorithm determines the minimum number of pulses required to perform all Cliffords for one particular combination of Clifford decompositions. However, each Clifford has an average of $38$ different decompositions, and so for $n$ qubits there are approximately $38^n$ different combinations of Clifford decompositions. Furthermore, applying the algorithm to all $38^n$ decomposition combinations would only determine an optimal Clifford compilation for one particular Clifford combination; the average number of pulses per Clifford combination is found by averaging over all $24^n$ possible Clifford combinations. This problem scales exponentially with $n$, and for $n=5$ qubits, as many as $24^5\cdot38^5 \approx 6.3\cdot10^{14}$ combinations of Clifford decompositions need to be considered. Nevertheless we have exactly calculated the average number of pulses per Clifford combination for up to $n=5$ qubits. For this, we employed several optimizations, that are discussed below.

  \section{Optimizing the Clifford compilation algorithm}
    \label{Optimizing the Clifford compilation algorithm}

    The first and simplest optimization arises from the observation that an optimal Clifford compilation for a certain Clifford combination $\left(C_{\alpha_1}, \dots, C_{\alpha_n}\right)$ is the same as for any permutation of those Cliffords. We therefore only determine an optimal Clifford compilation when $\beta_1 \leq \dots \leq \beta_n$. This already reduces the number of calculations exponentially ($81$ times less computations when $n=5$).

    In the second optimization, we place an upper bound $N^\text{ub}$ on the pulse sequence length. the upper bound $N^\text{ub}$ is given by the minimum number of pulses found so far that can compile a given Clifford combination. At each stage, the algorithm checks if the sum of the pulses in $P_\text{seq}$ and all distinct pulses left is equal to or greater than $N^\text{ub}$. If this is the case, a shorter combination of pulses using $P_\text{seq}$ is not possible. It therefore stops considering this sequence and proceeds to the next one. Initially $N^\text{ub}=5$, as the $5$-primitives method proves that there is always a decomposition of an arbitrary number of Cliffords into $5$ pulses. Note that, as $N^\text{ub}$ decreases, the frequency at which the algorithm stops considering sequences increases.

    The third optimization relies on decompositions with fewer pulses being more likely to result in an optimal Clifford compilation. The decompositions of every Clifford are therefore arranged in ascending number of pulses. The first decompositions compared are then those with the minimum number of pulses; these have the highest probability of finding an optimal Clifford compilation. Even if an optimal Clifford compilation is not found, it is more likely that $N^\text{ub}$ will be low. This optimization is especially effective in combination with the second optimization.

    The fourth optimization places a lower bound $N^\text{lb}$ on the number of pulses. For a given Clifford combination $\left(C_{\alpha_1}, \dots, C_{\alpha_n}\right)$, $N^\text{lb}$ is found by looking at the minimum number of pulses $N^\text{opt}$ previously found for all $n-1$ Clifford subsets. Since $N^\text{opt}$ for the $n$ Cliffords can never be less than $N^\text{opt}$ for any of the $n-1$ Clifford subsets, the maximum length of the $n-1$ Clifford subsets therefore places a lower bound $N^\text{lb}$ on $N^\text{opt}$ for the $n$ Cliffords. This means that if a pulse sequence is found whose length is equal to this $N^\text{lb}$, it is an optimal Clifford compilation, and all further search is aborted. This is in contrast to the second optimization, where only the particular sequence of pulses is aborted upon reaching $N^\text{ub}$. Furthermore, as $n$ increases, it becomes increasingly likely that the lower bound is equal to 5. In this case $N^\text{lb}=N^\text{ub}$, and so the $5$-primitives method is an optimal Clifford compilation. This optimization results in a largest gain in computation time, by several orders of magnitude.

    In the fifth, and most complicated, optimization, all decompositions composed of three pulses or less are separated from those composed of four pulses. First, all combinations of Clifford decompositions composed of three pulses or less are compared. This reduces the average number of decompositions per Clifford, from $38$ to $7$, resulting in an exponentially reduced number of total decomposition combinations. It is, however, not always the case that the optimal Clifford compilation is found using only up to three pulses per decomposition; sometimes optimal Clifford compilations requires that one of the decompositions is composed of four pulses. However, after comparing decompositions of three pulses or less, these four-pulse decompositions only need to be considered when $N^\text{lb} \leq 4$ and $N^\text{ub} =5$. If there is a sequence containing a four-pulse decomposition that outperforms any found using up to three-pulse decompositions and the $5$-primitives method, the sequence must consist of 4 pulses. Only one Clifford then has a four-pulse decomposition, while all other Cliffords are subsets of these four pulses. We therefore loop, for every Clifford, over each of the four-pulse decompositions, and test whether every other Cliffords can be decomposed into a subset of these four pulses. This changes the comparison of four-pulse decompositions from scaling exponentially with $n$ to scaling linearly.

    \begin{table}
      \begin{tabular}{c c || c c}
        \toprule
        number of qubits  & average pulses per Clifford & number of qubits  & average pulses per Clifford \\
        \midrule
        1 & 1.875 & 6  & 4.380 (12)\\
        2 & 2.925 & 7  & 4.570 (15)\\
        3 & 3.521 & 8  & 4.721 (10)\\
        4 & 3.874 & 9  & 4.808 (14)\\
        5 & 4.137 & 10 & 4.857 (24)\\
        \bottomrule
        %random sampling 5: 4.139(2)
      \end{tabular}
      \caption{The average pulses per Clifford after compilation. Values up to $n=5$ have been calculated exact, while values starting from $n=6$ have been determined using random sampling.}
      \label{tab:pulses per Clifford}
    \end{table}

    Using these five optimizations, we have calculated the average pulses per Clifford combination exactly for $n=5$ qubits within two hours. Furthermore, the average pulses per Clifford has been approximated for up to $n=10$ Cliffords using random sampling. The results are shown in Table~\ref{tab:pulses per Clifford}.
