% Todo:
% Change all the variables such that they are not in italics

\documentclass[12pt]{report}
\usepackage[a4paper]{geometry}
\usepackage[myheadings]{fullpage}
\usepackage{amsmath}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{graphicx, wrapfig, subcaption, setspace, booktabs}
% \usepackage[T1]{fontenc}
\usepackage[font=small, labelfont=bf]{caption}
\usepackage{fourier}
\usepackage[protrusion=true, expansion=true]{microtype}
\usepackage[english]{babel}
\usepackage{sectsty}
\usepackage{url, lipsum}
\usepackage{siunitx}
\usepackage{subcaption}
\usepackage[space]{grffile}
\usepackage[toc, page]{appendix}
\usepackage{braket}

\newcommand{\Ec}{E_\text{c}}
\newcommand{\Ej}{E_\text{J}}
\newcommand{\fbare}{f_\text{bare}}
\newcommand{\wbare}{\omega_\text{bare}}
\newcommand{\fres}{f_\text{r}}
\newcommand{\wres}{\omega_\text{r}}
\newcommand{\fqub}{f_\text{q}}
\newcommand{\wqub}{\omega_\text{q}}
\newcommand{\wdrive}{\omega_\text{d}}

\newcommand{\HRule}[1]{\rule{\linewidth}{#1}}
% \onehalfspacing
\setcounter{secnumdepth}{5}
\setcounter{tocdepth}{5}

%-------------------------------------------------------------------------------
% HEADER & FOOTER
%-------------------------------------------------------------------------------
\pagestyle{fancy}
\fancyhf{}
\setlength\headheight{15pt}
\fancyhead[L]{Serwan Asaad}
\fancyhead[R]{Delft University of Technology}
\fancyfoot[R]{Page \thepage\ of \pageref{LastPage}}
%-------------------------------------------------------------------------------
% TITLE PAGE
%-------------------------------------------------------------------------------

\begin{document}

\begin{titlepage}
\begin{center}
~\\ [4.0 cm]
\textsc{\LARGE Delft University of Technology}
\\ [3.0 cm]
\textsc{\Large Master Thesis}
\HRule{0.5 pt} \\
\LARGE \textbf{\uppercase{Master thesis}}
\HRule{2 pt} \\ [0.5 cm]

% Author and supervisor
\noindent
\begin{minipage}{0.4\textwidth}
\begin{flushleft} \large
\emph{Author:}\\
Serwan Asaad
\end{flushleft}
\end{minipage}%
\begin{minipage}{0.4\textwidth}
\begin{flushright} \large
\emph{Supervisor:} \\
Dr.~Alessandro Bruno
\end{flushright}
\end{minipage}
\\ [3.0 cm]
{\large \today}
\end{center}

\end{titlepage}


\author{
    Serwan Asaad
    Student ID: 4323475 \\
    Delft University of Technology \\
    Kavli Institute of Nanoscience\\
    Quantum Nanoscience Department\\
    Quantum Transport Group\\
    DiCarlo Lab}

\tableofcontents
\newpage

%-------------------------------------------------------------------------------
% Section title formatting
\sectionfont{\scshape}
%-------------------------------------------------------------------------------

%-------------------------------------------------------------------------------
% BODY
%-------------------------------------------------------------------------------

\section*{Introduction}

\part{Deep-reactive ion etched resonators}

\textbf{TODO:}
\begin{itemize}
  \item Explain heterodyne detection
  \item Explain VNA
  \item Explain that resonance frequency $\fres$ is not necessarily at the transmission minimum when the resonator exhibits asymmetry.
\end{itemize}





\part{Muxmon experiment}

  \textbf{large TODO:}
  \begin{itemize}
    \item Explain surface code architecture
    \item Explain the general structure of a chip:
    \begin{itemize}
      \item Feedline through which signal is sent and measured
      \item CPW resonators, capacitively coupled to feedline
      \item Single qubit coupled to resonators (coupling location?)
      \item Resonator buses
    \end{itemize}
  \end{itemize}

  \textbf{small TODO:}
  \begin{itemize}
    \item Rename DAC voltage to flux, and mention early on that this renaming will be used
    \item flux-bias line or flux bias line?
  \end{itemize}



  \chapter*{Introduction}

    At this moment circuit QED is at the stage where multi-qubit experiments are being realized.



  \chapter{Muxmon chip architecture}

    \textbf{Topics that should be explained in this section:}
    \begin{itemize}
      \item The Muxmon0 and Muxmon1 chip are designed with two purposes
      \begin{enumerate}
        \item Testing multiplexing using the Duplexer
        \item Explore qubit frequency re-use
      \end{enumerate}

      \item Explain similarities of chips
      \begin{itemize}
        \item Three qubits per chip
        \item All three qubits have individual flux tuning
        \item Air bridges are used, not only for connect the ground planes, but also such that the feed line can pass over other coplanar waveguides without contact \\
      \end{itemize}

      \item Explain differences between Muxmon0 and Muxmon1.
      \begin{itemize}
        \item The Muxmon0 chip has a driving line connected to each of the qubits. \\
            It has two resonator buses at \SI{4.9}{\giga \hertz} and \SI{5.0}{\giga \hertz}. \\
            These could also be used for two-qubit gates.
        \begin{description}
          \item[Advantage] Able to fully control each qubit individually, even when multiple qubits share the same frequency.
          \item[Advantage] Less coupling between data qubits.
          \item[Disadvantage] Requires more driving lines.
          \item[Disadvantage] Adds extra source of dissipation for the qubits.
        \end{description}
        \item The Muxmon1 chip has two driving lines, each capacitively coupled to one of the two data qubits, and to the ancilla qubit.
        \begin{description}
          \item[Advantage] Less driving lines required
          \item[Advantage] Less dissipation due to capacitive coupling
          \item[Disadvantage] Cannot individually control data qubit and ancilla qubit when they share the same frequency
          \item[Disadvantage] More coupling between qubits
        \end{description}
        \item Simplified model of the surface code
      \end{itemize}

      \item Explain concepts of cross-coupling and readout cross-talk
      \begin{description}
        \item[Cross-coupling] The coupling between qubits. \\
                    Cross-coupling leads to transfer of excitation.\\
                    An associated coupling strength \textbf{g} can be associated to cross-coupling.\\
                    Can be determined by driving one qubit extremely hard, and measuring signal from other qubit.\\
                    \textbf{TODO:} Show values of cross-coupling found, or do this in characterization section \\
                    \textbf{TODO:} Leads to coherent errors? \\
                    \textbf{TODO:} Two types of cross-coupling? Direct leakage of pulse pulse, and transfer of excitation? cross-driving?
        \item[Readout cross-talk] Coupling between a qubit and a resonator that are not directly coupled.\\
                      A part of the signal measured from one resonator is then due to the state of another qubit \\
                      \textbf{TODO:} Understand more behind readout cross-talk
      \end{description}

    \end{itemize}

    \textbf{Left to think about:}
    \begin{itemize}
      \item Should I already include items such as coherence times, the fact that Muxmon0 performs better than Muxmon 1?
      \item Where should I include coherence times versus frequency?
      \item Should the part on cross-coupling and readout cross-talk not be in characterization section?
      \item Should the section on the Duplexer go in here?
    \end{itemize}

    \textbf{Figures that need to be included:}
    \begin{itemize}
      \item Muxmon0 and Muxmon1 chip, preferably optical microscopy
      \item SEM image of air-bridges such that coplanar wave-guides cross without intersecting
      \item schematic of cross-coupling and readout cross-talk \\
          It could be good to create this using the actual Muxmon chip as background, with arrows indicating how the different effects operate
    \end{itemize}


  \chapter{Qubit characterization}
    \begin{description}
     \item[Description] This chapter gives a step-by-step description of how to find a resonator and qubit, and subsequently how to tune the qubit's parameters.
     \end{description}

    In the design of cQED chips, the parameters of the qubits and resonators are always targeted which are ideal for the experiment.
    For coplanar waveguide resonators one can already obtain relatively good parameters for the required dimensions from simple formulae \textbf{TODO:} refer to formula.
    For superconducting transmon qubits, however, finding the right dimensions that correspond to the desired parameters is a much more complicated process.
    The qubit's frequency, for instance, depends on the qubit's coupling energy $\Ec$ and Josephson energy $\Ej$. The coupling energy $\Ec$ can be reasonably estimated from classical simulations. Finding the right dimensions for the Josephson junction that result in the desired Josephson energy $\Ej$, however, is difficult, and usually physically testing different junctions is necessary to determine an accurate conversion from the desired $\Ej$ to the Josephson junction dimensions.

    Nevertheless, the actual parameters of the resonators and qubits are almost never where one expects them to be. Once the sample is cooled in the dilution refrigerator, an inevitable game of hide-and-seek follows with the goal of finding the frequency of the resonators and qubits, and subsequently determining their properties. This chapter describes the measurements that were performed to characterize the MuxMon samples.

    \section{Part I: Continuous-wave measurements}

      Once a sample is properly cooled down it is ready to be measured. At this stage the sample is still an unknown terrain, where the experimenter only has a rough map, containing the sample's targeted parameters, and the specific properties of the resonators and qubits.

      The first step is to look for signs of life. These manifest themselves as resonance frequencies of the resonators and the qubits that are coupled to them. As we are not yet interested in the properties of the resonators and qubits which can only be obtained through measurements with accurately timed pulses, we send continuous tones through the feedline, and measure deviations in the transmission. These measurements are known as continuous-wave measurements

      \subsection{Scanning for resonators}
      \label{sec:resonator-scan}
        Since communication with the qubits is mediated through their coupling to resonators, the first step is to find these resonators. This is done using a transmission measurement, in combination with heterodyne detection, and has been explained in section \textbf{TODO:} Create section in Resonator chapter.

        There is one difference in measuring a resonator when there is a qubit coupled to it. When considering the qubit as a two-level system, the behaviour of the coupled resonator-qubit system is governed by the Jaynes-Cummings Hamiltonian \cite{Reed}:

        \begin{equation}
          \hat{H} = \hbar \wres\left(\hat{a}^\dagger \hat{a} + \frac{1}{2} \right) + \frac{\hbar \wqub}{2}\hat{\sigma}_z + \hbar g \left(\hat{a}^\dagger \sigma_{-} + \hat{a}\sigma_{+}\right)
          \label{eq:Jaynes-Cummings}
        \end{equation}

        where $\wres$ is the bare resonance frequency of the resonator, $\wqub$ is the resonance frequency of the qubit's ground to excited state transition, and the qubit's two states are in the spin-representation. This Hamiltonian consists of three terms. The first term corresponds to the energy level of the resonator, the second to the energy level of the transmon, and the third is a coupling term between the two with coupling strength $g$.

        The difference between the resonator's frequency $\wres$ and the qubit's frequency $\wqub$ is given by the detuning $\Delta = \wqub - \wres$. If the magnitude of the detuning is large compared to the coupling strength $g$, the system is in the dispersive regime. In this case the Hamiltonian can be approximated by the dispersive Jaynes-Cummings Hamiltonian:

        \begin{equation}
          \hat{H} = \frac{\hbar \wqub^{'}}{2} \hat{\sigma}_z +  \left(\hbar \wres^{'} + \hbar \chi \hat{\sigma}_z\right) \hat{a}^\dagger \hat{a}
          \label{eq:dispersive-Jaynes-Cummings}
        \end{equation}

        The coupling between the qubit and resonator causes both qubit's frequency and the resonator's frequency to shift: $\wqub^{'} = \wqub + \chi_{01}$, $\wres^{'}=\wres - \chi_{12}/2$.

        Aside from experiencing a frequency shift dependent on the amount of detuning, Equation~\ref{eq:dispersive-Jaynes-Cummings} shows that the resonator also experiences a shift depending on the state of the qubit. The resonator's frequency is decreased by an amount $2 \chi$ when the qubit is in the excited state. The parameter $\chi$ is the dispersive shift, and is given by:

        \begin{equation}
          \chi = \chi_{01} - \chi_{12}/2 \approx \frac{g^2}{\Delta}\frac{\Ec}{\hbar \Delta - \Ec}
          \label{eq:dispersive-shift}
        \end{equation}

        where $\chi_{ij} = \frac{g_{ij}^2}{\omega_{ij}-\omega_c}$ are the partial dispersive shifts.

        Due to this coupling between resonator and qubit, it is important to choose the right RF power. When the amount of photons in the resonator reaches a certain point, this coupling will result in the resonator experiencing nonlinear effects. The resonator will thereby lose its Lorentzian lineshape. Therefore the RF power should be kept sufficiently low to avoid these nonlinear effects, while still maintaining a good signal-to-noise ratio.



        \textbf{TODO:}
        \begin{itemize}
          \item In the strong coupling regime (Leads to hybridization of qubit and resonator states: quton and fobit
          \item Explain that the quality factor is low because the resonator is coupled strongly to the qubit (equation including coupling to qubit?)
          \item Doesn't $\chi$ diverge when $\Delta \rightarrow \Ec$?
          \item explain concept of anharmonicity, and that $\alpha \approx E_c$
          \item Maybe explain concept of number splitting in dispersive Jaynes-Cummings. Number splitting is the phenomenon that the qubit's frequency shifts by an amount $2 \chi$ for every photon in the resonator.\\
                Alternatively mention this in another section.
          \item Mention that $g_{12}=\sqrt{g}$, and that other coupling strengths are exponentially suppressed in the transmon
        \end{itemize}

        \textbf{Figures:}
        \begin{itemize}
          \item Figure of transmission showing all three Muxmon0 resonators
        \end{itemize}

      \subsection{Powersweeping the resonators}
        Once the resonators have been located, the next stage is to find the qubit that is capacitively coupled to each of the resonators. Instead of directly scanning the entire frequency spectrum in search of the qubit, it is relatively straightforward to perform some initial measurements aimed at gaining information about our resonator and qubit, which will allow us to search for our qubit with much greater accuracy.

        As explained previously, the capacitive coupling between the resonator and qubit shifts the resonator frequency $\wres$ from its bare frequency. When the amount of photons in the resonator reaches a certain point, the resonator experiences nonlinearity, thereby losing its Lorentzian lineshape. When increasing the RF power even further, at a certain point the resonator regains its Lorentzian lineshape. In doing so its resonance frequency has shifted to its bare frequency $\wbare$. If this frequency shift is observed, it indicates that the resonator's frequency was shifted, and hence that the qubit is alive. Measuring this frequency shift is commonly done in a powersweep. A powersweep is a measurement in which a resonator scan is performed for a range of powers.

        A powersweep additionally provides information about at what power the resonator enters the nonlinear regime. For measurements involving the qubit the readout power must be below this threshold power. Furthermore, from the frequency shift between the dressed cavity frequency and the bare cavity frequency, the amount of detuning between the qubit and the resonator can be estimated using Equation~\ref{eq:dispersive-shift}.

        If no shift is observed, it could mean that the qubit is dead (e.g. because the Josephson junction is shorted). However, this is not necessarily the case. An alternative possibility is that the detuning between qubit and resonator is very large, and as a result the frequency shift cannot be discerned. At this point it is too early to draw conclusions, and we may almost draw the analogy with Schr\"odinger's cat in a box.

        \textbf{TODO:}
        \begin{itemize}
          \item Explain theory behind transition to bare cavity frequency (Reed's thesis has some information)
        \end{itemize}

        \textbf{Figures:}
        \begin{itemize}
          \item Powersweep of ancilla qubit
        \end{itemize}

      \subsection{Scan for qubit sweet-spots}
        Some of the qubits have a tunable resonance frequency. This is done through a superconducting quantum interference device (SQUID). In this case the two islands that compose the transmon qubit are connected by two Josephson junctions instead of one, effectively forming a loop. The SQUID loop is sensitive to the amount of flux passing through the loop. The amount of flux going through the SQUID loop can be changed by changing the surrounding magnetic field. This is commonly done by having a flux bias line in close proximity to the SQUID loop. Current flowing through the flux-bias line alters the magnetic field in the vicinity of the SQUID loop, and hence changes the amount of flux through the SQUID loop. A digital-to-analog converter is used to specify the amount of current that is sent through the flux bias line. Depending on the amount of flux through the SQUID loop, the resonance frequency of the qubit changes accordingly. these qubits are therefore called flux-tunable.

        For qubits that are flux-tunable, finding the sweet-spot of the qubit can be done without knowledge of the qubit's frequency. This can be done by sweeping the DAC voltage and measuring the shift in the resonance frequency. Because the frequency of the qubit varies as the amount of current through the flux-bias line changes, the detuning between the qubit and the resonator consequently changes. As a result the dispersive shift $\chi$, and therefore the resonator's frequency, also varies. At the sweet-spot of the qubit, the resonator's frequency $\wres$ is at a maximum. This is irrespective of whether the qubit's frequency $\wqub$ is above or below the resonator's frequency.

        The accurate way to measure the sweet-spot is to perform resonator scans as the DAC voltage is varied. The result is a 2D scan shown in \textbf{TODO:} Figure.

        A faster second approach for finding the qubit sweet-spot, at the cost of providing less information, is by choosing a fixed frequency close to the resonator's frequency $\wres$ (preferrably slightly below, where the transmission slope is steepest). By measuring the amount of transmission as the DAC voltage is being varied, one obtains essentially a line-cut of \textbf{TODO:} Figure. The idea this measurement is that if the qubit's frequency $\fqub$ decreases, the resonator's frequency also decreases, resulting in a decrease in transmission (closer to $\wres$). Likewise, if the qubit's frequency $\wqub$ increases, the resonator's frequency increases \textbf{TODO:} Why?, resulting in an increase in transmission (further away from $\wres$).

        At the qubit's sweet-spot, the resonator's frequency $\wres$ is at a maximum, and so the transmission should also be at a maximum. Furthermore, because the amount of detuning only depends on the deviation from the flux sweet-spot \textbf{TODO:} improve, the transmission should be symmetric with respect to the DAC voltage sweet-spot. If the resonator's frequency $\wres$ shifts by a large amount in the course of this measurement, it becomes harder to determine where the sweet-spot is (although even then often it can still be discerned). Nevertheless, this method is considerably faster than performing a full two-dimensional scan of frequency versus DAC voltage, and in most cases it works like a charm.

        In the case where the powersweep showed no measurable frequency shift, these two measurements are also useful in discerning whether or not the qubit is actually dead, or whether it was simply far detuned from the resonator.


        \textbf{TODO:}
        \begin{itemize}
          \item Explain how qubit's frequency has a cosine dependence on DAC
          \item Give detailed information on SQUID loop
          \begin{itemize}
            \item Why does the qubit frequency change in a SQUID loop
            \item Sweet-spot
          \end{itemize}
          \item Mention flux-noise?
          \begin{itemize}
            \item 1/f noise
            \item usually not limiting, as it is very slow
            \item This noise can be seen as occasional jumps (every few hours?) It would mean that every few hours the frequency must be recalibrated.
          \end{itemize}
        \end{itemize}

        \textbf{Figures:}
        \begin{itemize}
          \item SEM picture of SQUID loop, including flux-bias line
          \item Figure of 2D resonator scan vs DAC voltage
          \item Figure of 1D resonator fixed frequency DAC voltage scan
        \end{itemize}

      \subsection{Scanning for qubits}
        Once the preliminary measurements have been performed that characterize the resonators and provide hints about the whereabouts of the qubit it is time to actually find the qubit.

        The measurement to perform in order to find the qubit depends on the amount of detuning between the resonator and qubit, which can be estimated from powersweep measurements. If the amount of detuning is large compared to the coupling strength ($\Delta \gg  g$), the system is in the dispersive regime. In this case one commonly performs a two-tone spectroscopy to find the qubit's frequency. If, on the other hand, the detuning is comparable to the coupling strength ($\Delta \sim g$), the qubit and resonator are hybridized, and experience an avoided crossing. In such cases a normal transmission measurement suffices.

        If the qubit is flux-tunable, one important question to ask is: at what DAC voltage should the qubit be searched?

        One option is to choose zero DAC voltage. In most cases this is alright, but there are cases when this is a bad choice. For instance, trapped magnetic fields during cool-down could position the qubit near the anti-sweet-spot for zero DAC voltage, in which case finding the qubit will be next to impossible.

        A better option is to choose a DAC voltage that results in a detuning $\Delta$ that is large compared to coupling strength $g$, such that the system is in the disperisive regime. However, the detuning $\Delta$ should not be too high, as it would otherwise result in a negligible dispersive shift $\chi$.The optimum value is usually around a few hundred megahertz, although this is dependent on the device-specific parameters. The detuning can be approximated using powersweeps.

        \subsubsection{Spectroscopy}
          As was explained in section~\ref{sec:resonator-scan}, in the dispersive regime the resonator experiences a $2 \chi$ frequency shift dependent on the state of the qubit. In the case of a resonator capacitively coupled to the feedline, the transmission experiences a dip at the resonator's frequency. This dip will correspondingly shift when the qubit's state is switched. The transmission at the resonator's dip when the qubit is in the ground state will therefore be dependent on the state of the qubit (low when the qubit is in the ground state, high when the qubit is in the excited state). This is the property exploited in a two-tone spectroscopy measurement.

          In a two-tone spectroscopy measurement two tones are sent through the feedline.
          \begin{enumerate}
            \item A drive tone with varying frequency $\wdrive$.
            \item A measurement tone at the resonator's frequency when the qubit is in the ground state.
          \end{enumerate}

          The transmission through the feedline is measured while the frequency of the drive tone $\wdrive$ is swept. When the drive frequency $\wdrive$ is detuned from the qubit's frequency $\wqub$, the drive is off-resonant with respect to the qubit, and so we measure a low transmission due to a dip being present. However, when the drive frequency $\wdrive$ approaches the qubit's frequency $\wqub$, then the qubit will start to oscillate between its ground and excited state, with a rate dependent on the detuning between the drive frequency $\wdrive$ and the qubit's frequency $\wqub$. The qubit will therefore have a partial population in the excited state, resulting in a shift of the resonator frequency, dependent on the population in the excited state. This is measured as an increase in transmission.

          The minimum linewidth of the qubit using spectroscopy is set by its dephasing time $T^2$, which can be seen as the uncertainty in its frequency. However, the power of the drive tone causes an additional increase in the linewidth, due to stimulated emission of the qubit. This effect is known as power broadening. This effect can be quite useful for finding qubits, especially when designing high-quality qubits with a very narrow intrinsic linewidth. The optimal power for the drive strength is further dependent on the amount of detuning $\Delta$ between the qubit and resonator. The resonator effectively acts as a bandpass filter, centered around the resonator frequency. Therefore, the stronger the detuning, the more the drive tone is suppressed.

          The dispersive shift $2 \chi$ is also dependent on the amount of detuning $\Delta$ between the qubit and resonator. If the detuning $\Delta$ is large, the dispersive shift will be very small, and so the difference in transmission will also decrease. Since the resonator has a Lorentzian lineshape, at the resonance frequency this Lorentzian is flat, and so is insensitive to small deviations. To increase the contrast between the on-resonant and off-resonant transmission, it is usually advantageous to measure at a slight detuning $\delta$ away from the resonance frequency, where the transmission slope is high. Since the resonator frequency shifts down when the qubit is excited, it is better to have a positive detuning $\delta$ to ensure that the transmission increases as the drive frequence $\wdrive$ approaches the qubit frequency $\wqub$ and decreases as it leaves the qubit frequency.

          \textbf{TODO:} Spectroscopy section
          \begin{itemize}
              \item Is power broadening really due to stimulated emission?
              \item Explain optimal RF power
              \item Is the gradual increase really due to partial population? Is it then an average of the partial population? Or do you get other effects as well?
          \end{itemize}


        \subsubsection{Avoided crossing}
          When the detuning $\Delta$ between the qubit and resonator is not large compared to their coupling strength $g$, the qubit and resonator experience an avoided crossing. Because all of the qubits in the Muxmon chips are considerably lower in frequency compared to their resonators, the system is always in the dispersive regime, and so the system never approaches the avoided crossing. Nevertheless it is worth mentioning the avoided crossing briefly, as it is a breeding ground for interesting physics.

          At the avoided crossing the system is not in the dispersive regime, and so the dispersive Jaynes-Cummings Hamiltonian no longer applies. In this case the resonator and qubit are hybridized, and one can no longer speak of a qubit and resonator as separate entities. Instead, this hybridization results in a so-called quton and phobit.

          \textbf{Avoided crossing info:}
          \begin{itemize}
            \item The coupling strength $g$ is the minimum distance be~tween the splitting
            \item From Reed's thesis p.63 explanation of this avoided crossing is given\\
            \begin{align}
             E_0 = & -\frac{\hbar \Delta}{2}\\
             E_1 = & n \hbar\omega_r \pm \frac{\hbar}{2}\sqrt{4g^2n + \Delta^2}
            \end{align}\\
            Joining $E_0 + E_1$ results in a qubit approaching a resonator from the top.\\
            When the frequency of the qubit equals that of the resonator, the energy difference reaches a minimum, and is equal to $2g$.
          \end{itemize}

          \textbf{TODO:} Avoided crossing
          \begin{itemize}
            \item Explain the quton fobit behaviour near the avoided crossing
            \item Explain how one can extract coupling from avoided crossing
            \item Explain that for the Muxmon qubit this effect is not present
          \end{itemize}

          \textbf{figures:}
          \begin{itemize}
            \item Figure of avoided crossing
          \end{itemize}


        \textbf{TODO:}
        \begin{itemize}
          \item Use relatively high source power, results in power broadening
          \item Mention what to do if qubit is close to or far away from resonator
          \item Mention the term transmission measurement earlier on.
          \item Pulsed spectroscopy
        \end{itemize}

      \subsection{Tracking the qubits}
        For flux-tunable qubits one is usually not interested in finding the frequency at one specific flux value. More important is finding how this frequency changes with varying flux. A naive approach would be to perform a two-dimensional scan of a fixed frequency range versus flux. At a certain flux the qubit crosses the boundary of the chosen frequency window. Every time this happens a new two-dimensional scan has to be performed with an updated frequency window. The larger the chosen frequency window, the less often this has to be updated. On the other hand, choosing a large window also means that a larger portion of the scan is spent not measuring the qubit. There is therefore a trade-off between measurement time and degree of human intervention. Furthermore, the resonator frequency also depends on the amount of detuning. Therefore the frequency of the measurement tone must also be updated every now and then.

        As an alternative approach I have created a modified version of the spectroscopy versus flux scan, known as tracked spectroscopy. In this approach after every spectroscopy scan the qubit frequency is extracted through fitting. From the qubit frequencies measured in previous scans the expected frequency at the next flux value is extrapolated. The frequency window of the next spectroscopy scan are then centered around the expected qubit frequency. The qubit is therefore tracked as its frequency changes. The same method is applied to update the resonator frequency.

        Tracked spectroscopy has several advantages over the two-dimensional spectroscopy versus flux scans. First of all, since the qubit's frequency follows a smooth curve (see Equation~\textbf{TODO:} Refer to eqn), the qubit's frequency can be estimated quite accurately. The frequency windows can therefore be narrow. This greatly reduces the measurement time. Secondly, tracked spectroscopy does not need any human intervention, as the frequency window is automatically updated after every spectroscopy scan. Therefore measuring the flux-dependence of the qubit frequencies is an automatized process (provided that the qubit frequency can correctly be extracted).

        For more information on the tracked spectroscopy algorithm see appendix~\ref{sec:app-Tracked spectroscopy}.

        \textbf{Improvements}
        \begin{itemize}
          \item Avoided crossing
          \item Variable RF and drive power
        \end{itemize}
        \textbf{TODO:}
        \begin{itemize}
          \item Maybe mention possible improvements
        \end{itemize}
        \textbf{Figures:}
        \begin{itemize}
          \item Tracked spectroscopy of qubit and resonator
        \end{itemize}

      \subsection{Flux matrix}
        When a current is passed through a flux-bias line, it is not only the flux through the SQUID of the qubit directly connected to it that is affected. Instead, the flux through SQUIDs of neighbouring qubits are also affected, albeit to a lesser extent. Therefore changing the frequency of one qubit by changing its corresponding flux-bias line current also affects the frequencies of the other flux-tunable qubits on the chip. The effect that the current passing through flux-bias lines has on the frequencies of the different qubits can be decoupled by correcting the flux cross-coupling effects. This is done by implementing a flux matrix.

        A flux matrix $\boldsymbol{F}$ is an $n \times n$ matrix, where $n$ is the number of flux-tunable qubits. Each row corresponds to a virtual flux, and can be interpreted as follows: in a row $F_i = \left{f_{i1}, \dots, f_{in}\right}$ each element $F_{ij}$ corresponds to the relative amount by which the flux-bias line of qubit $j$ should be changed, such that only the frequency of qubit $i$ changes, whilst the frequencies of the other qubits remain fixed. This results in $n$ decoupled virtual flux parameters.

        Creating a flux matrix is done by first determining for each qubit how much every flux-bias-line affects its frequency.







      \textbf{TODO:}
      \begin{itemize}
        \item Conversion slope matrix to flux matrix
        \item Show that under current model there is a one-to-one correspondence between dac and flux
        \item mention that flux used previously is not the whole story, due to cross-coupling flux effects
        \item The diagonal elements of the matrices should be much greater than the off-diagonal elements
        \item Flux sweet-spot
      \end{itemize}

    \section{Part II: Time-domain measurements}








  \chapter{Calibration routines}


  \chapter{Randomized benchmarking}

    \section{Second excited state}



\begin{appendices}

  \chapter{Additional notes}
    \section{Qubit characterization}
      \subsection{Part I: Continuous-wave measurements}
        \subsubsection{Powersweep}
          \begin{itemize}
            \item If the resonator seems to disappear after the transition from dressed frequency to bare frequency (or vice versa), this is likely due to the qubit being extremely close to the resonator, and so the frequency shift is large.
          \end{itemize}
        \subsubsection{Spectroscopy}
          \begin{itemize}
            \item If the deviation in transmission becomes less due to more detuning, increasing the power can also increase the contrast.
          \end{itemize}
  \chapter{Algorithms}
    \section{Tracked spectroscopy}
    \label{sec:app-Tracked spectroscopy}
      \begin{itemize}
        \item Information may lie in amplitude or in phase, or in a combination of the two. For most accurate measure, calculate distance from ground state.
      \end{itemize}
    \section{Peak finding}
      \subsection{Normal peak finder}
      \subsection{Derivative peak finder}
    \section{Compiled RB?}

\end{appendices}

\bibliographystyle{plain}
\bibliography{bibliography}


\end{document}